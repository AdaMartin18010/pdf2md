# GUI启动指南

## 问题诊断结果

经过测试，系统环境正常：

- ✅ Python环境正常
- ✅ tkinter功能正常
- ✅ 缓存管理器正常
- ✅ 批量处理器正常
- ✅ 内存使用正常（25.9%）

## 启动方式

### 1. 安全启动器（推荐）

```bash
python safe_gui_starter.py
```

**特点**：

- 显示系统资源信息
- 提供三种启动模式
- 自动设置环境变量
- 避免内存占用过高

**启动模式**：

- **安全模式**：禁用GPU，限制内存，推荐首次使用
- **标准模式**：平衡性能和资源
- **完整模式**：所有功能，可能占用较多资源

### 2. 基础GUI测试

```bash
python basic_tkinter_test.py
```

**特点**：

- 测试基础GUI功能
- 验证tkinter正常工作
- 快速诊断问题

### 3. 简单GUI测试

```bash
python test_simple_gui.py
```

**特点**：

- 简化版GUI界面
- 基本文件选择功能
- 组件连接测试

### 4. 原始GUI（可能占用较多资源）

```bash
python pdf2md_gui.py
```

**特点**：

- 完整功能GUI
- 可能自动预加载模型
- 建议在资源充足时使用

## 内存优化建议

### 环境变量设置

在启动前设置以下环境变量可以降低资源占用：

```bash
# 禁用GPU（如果不需要）
set CUDA_VISIBLE_DEVICES=

# 限制线程数
set OMP_NUM_THREADS=2

# 禁用并行处理
set TOKENIZERS_PARALLELISM=false

# 限制GPU内存分配
set PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:64
```

### GUI设置优化

在GUI中：

1. 进入"设置"选项卡
2. 取消勾选"自动预加载模型"
3. 将"最大并发数"设置为1
4. 将"处理设备"设置为"cpu"

## 监控工具

### 内存监控

```bash
# 监控30秒
python memory_monitor.py monitor 30

# 测试模型加载影响
python memory_monitor.py test
```

### 调试工具

```bash
# 完整系统检查
python debug_gui_issue.py
```

## 故障排除

### 问题1：GUI启动后立即退出

**解决方案**：

1. 使用调试工具检查系统
2. 尝试安全启动器
3. 检查是否有其他程序冲突

### 问题2：内存占用过高

**解决方案**：

1. 使用安全模式启动
2. 禁用自动预加载
3. 限制并发数
4. 使用CPU模式

### 问题3：GPU显存不足

**解决方案**：

1. 禁用GPU，使用CPU模式
2. 关闭其他GPU程序
3. 重启系统释放显存

## 推荐使用流程

### 首次使用

1. 运行 `python debug_gui_issue.py` 检查系统
2. 运行 `python safe_gui_starter.py` 启动安全启动器
3. 选择"安全模式"启动
4. 在GUI中禁用自动预加载

### 日常使用

1. 直接运行 `python safe_gui_starter.py`
2. 根据系统资源选择合适模式
3. 定期清理模型缓存

### 批量处理

1. 使用命令行版本：`python enhanced_batch_processor.py`
2. 设置较小的并发数
3. 分批处理大量文件

## 性能对比

| 启动方式 | 内存占用 | GPU占用 | 启动速度 | 功能完整性 |
|---------|---------|---------|---------|-----------|
| 安全启动器 | 低 | 无 | 快 | 完整 |
| 原始GUI | 高 | 高 | 慢 | 完整 |
| 简单GUI | 低 | 无 | 快 | 基础 |

## 联系支持

如果问题仍然存在：

1. 运行调试工具收集信息
2. 检查系统资源使用情况
3. 提供错误日志和系统信息

---

**总结**：系统环境正常，建议使用安全启动器来避免内存和GPU占用过高的问题。
